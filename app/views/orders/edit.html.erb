<h1>送り先登録</h1>
<% if @change_order.errors.any? %>
	<div id="error_explanation">
		<ul>
		<% @change_order.errors.full_messages.each do |msg| %>
			<li><%= msg %></li>
		<% end %>
		</ul>
	</div>
<% end %>

<%= form_for @change_order do |f| %>
	<div class="field">
		<%= f.label :name, "NAME" %>
		<%= f.text_field :name %>
	</div>
	<br>
	<div class="field">
		<%= f.label :address, "ADDRESS" %>
		<%= f.label :postal, "〒" %>
		<%= f.text_field :postal %>
		<%= f.text_field :address %>
	</div>
	<br>
	<div class="field">
		<%= f.label :payment_method, "PAYMENT" %>
		<%= f.select(:payment_method,
		 { '代金引換' => 1, '銀行振込' => 2, 'カード払い' => 3 },
		 { include_blank: '選択してください'},
		 { id: 'info'}) %>
	</div>
	<div id='card_info'>
	</div>
	
	<div id='defo_info'>
		<% if @change_order.payment_method == 3 %>
			<% @card_info = @change_order.card_info %>
			<%= render 'shared/form_card' %>
		<% end %>
	</div>

	<script type="text/javascript">
		$(document).ready(function(){
			$('#info').change(function(){
				var num = $('#info').val();
				if(num == 3){
					$.get("<%= new_card_info_path %>")
					$('#defo_info').fadeOut();
				}else if(num == 1){
					$('#card_info').html("　手数料がかかります！");
					$('#defo_info').fadeOut();
				}else{
					$('#card_info').html("");
					$('#defo_info').fadeOut();
				}
			});
		});
	</script>
	
	<div class="field">
		<%= f.label :phone_number, "PHONE_NUMBER" %>
		<%= f.text_field :phone_number %>
	</div>
	<div class="action">
		<%= f.submit "送信" %>
	</div>
<% end %>

<div id="action">
	<%= link_to "戻る", materials_path %>
</div>
<%#= render 'shared/form_order' %>